{
    "name": "SAP-S4-Public-DCR",
    "apiVersion": "2023-03-11",
    "type": "Microsoft.Insights/dataCollectionRules",
    "location": "{{location}}",
    "properties": {
      "dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
      "streamDeclarations": {},
      "destinations": {
        "logAnalytics": [
          {
            "workspaceResourceId": "{{workspaceResourceId}}",
            "name": "clv2ws1"
          }
        ]
      },
      "dataFlows": [
        {
          "streams": [
            "Microsoft-ABAPAuditLog"
          ],
          "destinations": [
            "clv2ws1"
          ],
          "transformKql": "source\n| extend AgentId = \"S4 Public Cloud\", ClientID = slgmand, Computer = terminal_name, Email = coalesce(email_adress, \"\"), MessageClass = eventID, MessageText = rsau_text, SAL_DATE = format_datetime(todatetime(log_tstmp), \"yyyy-MM-dd\"), SAL_TIME = format_datetime(todatetime(log_tstmp), \"HH:mm:ss\"), SystemID = sid, UpdatedOn = todatetime(log_tstmp), TransactionCode = slgtc, User = UserID, USERALIAS = useralias, Variable1 = coalesce(param_a, \"\"), Variable2 = coalesce(param_b, \"\"), Variable3 = coalesce(param_c, \"\"), Variable4 = coalesce(param_d, \"\"), TimeGenerated = coalesce(todatetime(log_tstmp), now())",
          "outputStream": "Microsoft-ABAPAuditLog"
        }
      ]
    }
}