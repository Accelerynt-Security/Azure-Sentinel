{
    "name": "SAP-S4-Public-DCR",
    "apiVersion": "2022-06-01",
    "type": "Microsoft.Insights/dataCollectionRules",
    "location": "{{location}}",
    "properties": {
      "dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
      "streamDeclarations": {},
      "destinations": {
        "logAnalytics": [
          {
            "workspaceResourceId": "{{workspaceResourceId}}",
            "name": "clv2ws1"
          }
        ]
      },
      "dataFlows": [
        {
          "streams": [
            "Microsoft-ABAPAuditLog"
          ],
          "destinations": [
            "clv2ws1"
          ],
          "transformKql": "source\n| extend AgentId = \"S4-Public-Cloud\", ClientID = slgmand, Computer = terminal_name, Email = coalesce(email_adress, \"\"), MessageClass = eventID, MessageText = rsau_text, SAL_DATE = format_datetime(todatetime(log_tstmp), \"yyyy-MM-dd\"), SAL_TIME = format_datetime(todatetime(log_tstmp), \"HH:mm:ss\"), SystemID = sid, UpdatedOn = todatetime(log_tstmp), TransactionCode = slgtc, User = UserID, Variable1 = coalesce(param_a, \"\"), Variable2 = coalesce(param_b, \"\"), Variable3 = coalesce(param_c, \"\"), Variable4 = coalesce(param_d, \"\")\n| project AgentId, ClientID, Computer, Email, MessageClass, MessageText, SAL_DATE, SAL_TIME, SystemID, UpdatedOn, TransactionCode, User, Variable1, Variable2, Variable3, Variable4",
          "outputStream": "Microsoft-ABAPAuditLog"
        }
      ]
    }
}