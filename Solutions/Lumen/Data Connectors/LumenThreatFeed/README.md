# Lumen Threat Feed Connector - Azure Durable Functions

## Overview

This Azure Functions data connector uploads threat intelligence indicators generated by Black Lotus Labs to Microsoft Sentinel.

## What It Does

The connector automatically:

- Downloads latest list of STIX-formatted ipv4 and domain threat intelligence indicators from Lumen Reputation API on a daily schedule.
- Batches data into chunks.
- Chunks are uploaded to the Microsoft Sentinel `ThreatIntelIndicators` table via the [STIX Object Upload API](https://learn.microsoft.com/en-us/azure/sentinel/stix-objects-api).
- Temp files are cleaned up after upload is complete.

## Durable Functions Structure

- **timer_starter_function**: Cron based orchestration timer.
- **orchestrator_function**: Orchestrates the upload by splitting indicators into batches and calling the activity function for each batch.
- **activity_upload_from_disk**: Handles uploading a single batch of indicators to Sentinel.
- **activity_cleanup_temp_file**: Cleanup function to remove temp files used for processing.

## Requirements

- Azure Functions runtime v4 (`FUNCTIONS_EXTENSION_VERSION=~4`)
- Python 3.12 (`linuxFxVersion: Python|3.12`)
- Durable Functions extension (`azure-functions-durable`)

## Usage

- Upload runs on a cron schedule defined in `timer_starter_function\function.json` (default `0 0 8 * * *`).
- The orchestration will process all indicators in batches, avoiding timeouts.

## Support

For technical issues or questions about this connector:

- **Lumen API access**: Contact Lumen support
- **Azure configuration**: Contact your system administrator
- **Connector functionality**: Review Azure Functions logs in the Azure portal

---

*This connector requires active Lumen Reputation API access and Microsoft Sentinel workspace permissions.*
