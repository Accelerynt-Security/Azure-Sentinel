{
    "id": "M365Assets",
    "title": "Microsoft 365 Assets",
    "publisher": "Microsoft",
    "logo": "https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Workbooks/Images/Logos/office365_logo.svg",
    "descriptionMarkdown": "The Microsft 365 (formerly, Office 365) asset connector gives richer insights into ongoing user activities in Microsoft Sentinel by supplementing activity logs with details such as owners, permissions, retention policies and sensitivity labels.",
    "graphQueries": [
        {
            "metricName": "Total data received",
            "legend": "Microsoft 365 User Activity logs",
            "baseQuery": "MicrosoftAuditEventLogs\n| where EventProduct == \"Microsoft365_test\""
        }
    ],
    "sampleQueries": [
        {
            "description": "Get a sample of Microsoft 365 User Activity logs",
            "query": "MicrosoftAuditEventLogs\n | where EventProduct == \"Microsoft365_test\" | take 10"
        }
    ],
    "dataTypes": [
        {
            "name": "MicrosoftAuditEventLogs",
            "lastDataReceivedQuery": "MicrosoftAuditEventLogs\n | where EventProduct == \"Microsoft365_test\" |summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
        }
    ],
    "connectivityCriteria": [
        {
            "type": "HasDataConnector"
        }
    ],
    "permissions": {
        "tenant": [
            "GlobalAdmin",
            "SecurityAdmin"
        ]
    },
    "instructionSteps": [
        {
            "description": "1.Connect Microsoft 365 assets (formerly, Office 365) to Microsoft Sentinel",
            "instructions": [
                {
                    "type": "Markdown",
                    "parameters": {
                        "content": "✔ Exchange\n\n ✔ SharePoint and OneDrive"
                    }
                }
            ]
        }
    ]
}
