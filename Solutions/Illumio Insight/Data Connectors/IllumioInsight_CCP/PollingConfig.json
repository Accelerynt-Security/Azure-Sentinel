{
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2021-10-01-preview",
    "name": "IllumioInsights",
    "location": "[parameters('workspace-location')]",
    "kind": "RestApiPoller",
    "properties": {
        "connectorDefinitionName": "IllumioInsightsDefinition",
        "dataType": "IlumioInsights",
        "auth": {
            "type": "APIKey",
            "ApiKey": "[[parameters('apiToken')]",
            "ApiKeyName": "x-auth-key",
            "ApiKeyIdentifier": ""
        },
        "request": {
            "apiEndpoint": "https://insights.graph.illum.io/api/v1/resource-insights",
            "queryWindowInMin": 15,
            "queryTimeFormat": "UnixTimestampInMills",
            "queryParameters": {
                "after": "{_QueryWindowEndTime}"
            },
            "timeoutInSeconds": 60,
            "rateLimitQPS": 10,
            "headers": {
                "Accept": "application/json",
                "User-Agent": "Scuba",
                "x-azure-tenant-id": "[[parameters('tenantId')]",
                "x-illumio-tenant-id": "[[parameters('illumioTenantId')]"
            },
            "httpMethod": "Get"
        },
        "response": {
            "eventsJsonPaths": [
                "$"
            ],
            "ConvertChildPropertiesToArray": true,
            "format": "json"
        },
        "dcrConfig": {
            "streamName": "ILUMIO_INSIGHTS",
            "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
            "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
        }
    }
}