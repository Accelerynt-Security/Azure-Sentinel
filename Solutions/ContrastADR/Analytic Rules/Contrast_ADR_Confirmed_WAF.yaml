id: 93641436-afb3-4921-8828-ceab0d15aaab
name: Contrast ADR - WAF Alert Correlation
description: |
  'Correlates Contrast ADR security alerts with WAF logs to identify confirmed attack attempts that were either exploited or blocked. This rule helps security teams prioritize incidents by focusing on attacks that have been validated by application security monitoring.'
severity: Medium
status: Available
requiredDataConnectors:
  - connectorId: ContrastADRDataConnector
    dataTypes:
      - ContrastADR_CL
queryFrequency: 5m
queryPeriod: 5m
triggerOperator: gt
triggerThreshold: 0
query: |
  ContrastADR_CL
    | where result_s =~ "exploited" or result_s =~ "blocked"
    | project-rename ip_s=SourceIP
    | join kind=inner (WAFLogs_CL | where TimeGenerated >= ago(5m)) on ip_s
alertDetailsOverride:
  alertDisplayNameFormat: 'WAF Alert Confirmed {{result_s}} by Contrast ADR on {{application_name_s}}'
  alertDescriptionFormat: 'Attack {{result_s}} on application {{application_name_s}} via endpoint {{request_headers_referer_s}} - confirmed by Contrast ADR correlation with WAF logs'
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: true
    reopenClosedIncident: false
    lookbackDuration: PT1H
    matchingMethod: Selected
eventGroupingSettings:
  aggregationKind: AlertPerResult
kind: Scheduled
version: 1.0.0