{
    "name": "OnapsisVulnerabilityIntegration-DCR",
    "apiVersion": "2022-06-01",
    "type": "Microsoft.Insights/dataCollectionRules",
    "location": "{{location}}",
    "properties": {
        "dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
        "streamDeclarations": {
            "Custom-Onapsis_CL": {
                "columns": [
                {
                    "name": "incident_type",
                    "type": "string"
                },
                {
                    "name": "asset_name",
                    "type": "string"
                },
                {
                    "name": "confidence",
                    "type": "real"
                },
                {
                    "name": "created_at",
                    "type": "datetime"
                },
                {
                    "name": "incident_name",
                    "type": "string"
                },
                {
                    "name": "job_name",
                    "type": "string"
                },
                {
                    "name": "matching_rule",
                    "type": "string"
                },
                {
                    "name": "severity",
                    "type": "string"
                },
                {
                    "name": "system_type",
                    "type": "string"
                },
                {
                    "name": "username",
                    "type": "string"
                },
                {
                    "name": "alarm_name",
                    "type": "string"
                },
                {
                    "name": "alarm_profile_id",
                    "type": "real"
                },
                {
                    "name": "TimeGenerated",
                    "type": "DateTime"
                }
            ]
            }
        },
        "destinations": {
            "logAnalytics": [
                {
                    "workspaceResourceId": "{{workspaceResourceId}}",
                    "name": "clv2ws1"
                }
            ]
        },
        "dataFlows": [
            {
                "streams": [
                    "Custom-Onapsis_CL"
                ],
                "destinations": [
                    "clv2ws1"
                ],
                "transformKql": "| extend TimeGenerated = created_at",
                "outputStream": "Custom-Onapsis_CL"
            }
        ]
    }
}