[
    {
        "name": "GKEAuditLogs",
        "apiVersion": "2024-09-01",
        "type": "Microsoft.SecurityInsights/dataConnectors",
        "kind": "GCP",
        "location": "{{location}}",
        "properties": {
            "connectorDefinitionName": "GKECCPDefinition",
            "dataType": "GKEAuditLogs_CL",
            "dcrConfig": {
                "streamName": "Custom-GKEAuditLogs",
                "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
            },
            "auth": {
                "serviceAccountEmail": "{{GCPServiceAccountEmail}}",
                "projectNumber": "{{GCPProjectNumber}}",
                "workloadIdentityProviderId": "{{GCPWorkloadIdentityProviderId}}"
            },
            "request": {
                "projectId": "{{GCPProjectId}}",
                "subscriptionNames": [
                    "{{GCPSubscriptionName}}"
                ]
            }
        }
    },
    {
        "name": "GKEAPIServerLogs",
        "apiVersion": "2024-09-01",
        "type": "Microsoft.SecurityInsights/dataConnectors",
        "kind": "GCP",
        "location": "{{location}}",
        "properties": {
            "connectorDefinitionName": "GKECCPDefinition",
            "dataType": "GKEAPIServerLogs_CL",
            "dcrConfig": {
                "streamName": "Custom-GKEAPIServerLogs",
                "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
            },
            "auth": {
                "serviceAccountEmail": "{{GCPServiceAccountEmail}}",
                "projectNumber": "{{GCPProjectNumber}}",
                "workloadIdentityProviderId": "{{GCPWorkloadIdentityProviderId}}"
            },
            "request": {
                "projectId": "{{GCPProjectId}}",
                "subscriptionNames": [
                    "{{GCPSubscriptionName}}"
                ]
            }
        }
    },
    {
        "name": "GKESchedulerLogs",
        "apiVersion": "2024-09-01",
        "type": "Microsoft.SecurityInsights/dataConnectors",
        "kind": "GCP",
        "location": "{{location}}",
        "properties": {
            "connectorDefinitionName": "GKECCPDefinition",
            "dataType": "GKESchedulerLogs_CL",
            "dcrConfig": {
                "streamName": "Custom-GKESchedulerLogs",
                "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
            },
            "auth": {
                "serviceAccountEmail": "{{GCPServiceAccountEmail}}",
                "projectNumber": "{{GCPProjectNumber}}",
                "workloadIdentityProviderId": "{{GCPWorkloadIdentityProviderId}}"
            },
            "request": {
                "projectId": "{{GCPProjectId}}",
                "subscriptionNames": [
                    "{{GCPSubscriptionName}}"
                ]
            }
        }
    },
    {
        "name": "GKEControllerManagerLogs",
        "apiVersion": "2024-09-01",
        "type": "Microsoft.SecurityInsights/dataConnectors",
        "kind": "GCP",
        "location": "{{location}}",
        "properties": {
            "connectorDefinitionName": "GKECCPDefinition",
            "dataType": "GKEControllerManagerLogs_CL",
            "dcrConfig": {
                "streamName": "Custom-GKEControllerManagerLogs",
                "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
            },
            "auth": {
                "serviceAccountEmail": "{{GCPServiceAccountEmail}}",
                "projectNumber": "{{GCPProjectNumber}}",
                "workloadIdentityProviderId": "{{GCPWorkloadIdentityProviderId}}"
            },
            "request": {
                "projectId": "{{GCPProjectId}}",
                "subscriptionNames": [
                    "{{GCPSubscriptionName}}"
                ]
            }
        }
    },
    {
        "name": "GKEHPADecisionLogs",
        "apiVersion": "2024-09-01",
        "type": "Microsoft.SecurityInsights/dataConnectors",
        "kind": "GCP",
        "location": "{{location}}",
        "properties": {
            "connectorDefinitionName": "GKECCPDefinition",
            "dataType": "GKEHPADecisionLogs_CL",
            "dcrConfig": {
                "streamName": "Custom-GKEHPADecisionLogs",
                "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
            },
            "auth": {
                "serviceAccountEmail": "{{GCPServiceAccountEmail}}",
                "projectNumber": "{{GCPProjectNumber}}",
                "workloadIdentityProviderId": "{{GCPWorkloadIdentityProviderId}}"
            },
            "request": {
                "projectId": "{{GCPProjectId}}",
                "subscriptionNames": [
                    "{{GCPSubscriptionName}}"
                ]
            }
        }
    },
    {
        "name": "GKEApplicationLogs",
        "apiVersion": "2024-09-01",
        "type": "Microsoft.SecurityInsights/dataConnectors",
        "kind": "GCP",
        "location": "{{location}}",
        "properties": {
            "connectorDefinitionName": "GKECCPDefinition",
            "dataType": "GKEApplicationLogs_CL",
            "dcrConfig": {
                "streamName": "Custom-GKEApplicationLogs",
                "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
                "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
            },
            "auth": {
                "serviceAccountEmail": "{{GCPServiceAccountEmail}}",
                "projectNumber": "{{GCPProjectNumber}}",
                "workloadIdentityProviderId": "{{GCPWorkloadIdentityProviderId}}"
            },
            "request": {
                "projectId": "{{GCPProjectId}}",
                "subscriptionNames": [
                    "{{GCPSubscriptionName}}"
                ]
            }
        }
    }
]
